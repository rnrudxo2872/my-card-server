# MyCard Server â€” í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸

## âš ï¸ Claude í–‰ë™ ê·œì¹™

- **ClaudeëŠ” ì´ í”„ë¡œì íŠ¸ì˜ íŒŒì¼ì„ ì§ì ‘ ìƒì„±/ìˆ˜ì •í•˜ì§€ ì•ŠëŠ”ë‹¤ (md íŒŒì¼ ì œì™¸ - ìŠ¤í™ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•¨)**
- ì˜¤ì§ **ë‹¨ê³„ë³„ ê°€ì´ë“œì™€ ì„¤ëª…ë§Œ ì œê³µ**í•œë‹¤
- ì‚¬ìš©ìê°€ ì§ì ‘ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ê³  ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤
- í•µì‹¬ ì„¤ê³„ ê²°ì •ì€ ì‚¬ìš©ìì—ê²Œ ì„ íƒê¶Œì„ ì œê³µí•œë‹¤

## í”„ë¡œì íŠ¸ ê°œìš”

- **ëª©ì **: ì¹´ë“œ ê²°ì œ ì™„ë£Œ ì²˜ë¦¬ì— ë”°ë¥¸ ê²°ì œ ë‚´ì—­ ê¸°ë¡ ë° ì¡°íšŒ REST API ì„œë²„
- **í”„ë¡œì íŠ¸ëª…**: mycard-server

## ê¸°ìˆ  ìŠ¤íƒ (í™•ì •)

| í•­ëª©         | ì„ íƒ                     | ë¹„ê³                          |
| ------------ | ------------------------ | ---------------------------- |
| ì–¸ì–´         | **Go**                   | v1.25                        |
| í”„ë ˆì„ì›Œí¬   | **Gin**                  | v1.11.0                      |
| ORM          | **GORM**                 | v1.31.1                      |
| ë°ì´í„°ë² ì´ìŠ¤ | **PostgreSQL** (AWS RDS) |                              |
| ì¸í”„ë¼ ê´€ë¦¬  | **Terraform**            | IaC (Infrastructure as Code) |
| ì»¨í…Œì´ë„ˆ     | **Docker**               | v27.4.0 ì„¤ì¹˜ í™•ì¸ë¨          |
| ë°°í¬ ëŒ€ìƒ    | **AWS ECS Fargate**      | ì„œë²„ë¦¬ìŠ¤ ì»¨í…Œì´ë„ˆ            |

## AWS ì•„í‚¤í…ì²˜ (ëª©í‘œ)

```
ì¸í„°ë„·
  â†“
[ALB - Application Load Balancer]
  â†“
[ECS Fargate - Go/Gin ì„œë²„]      â† Public Subnet
  â†“
[RDS PostgreSQL]                  â† Private Subnet
```

## Terraform íŒŒì¼ êµ¬ì¡° (ëª©í‘œ)

```
terraform/
â”œâ”€â”€ main.tf          # í”„ë¡œë°”ì´ë” ì„¤ì •
â”œâ”€â”€ variables.tf     # ë³€ìˆ˜ ì •ì˜
â”œâ”€â”€ outputs.tf       # ì¶œë ¥ê°’ (ALB URL ë“±)
â”œâ”€â”€ vpc.tf           # VPC, ì„œë¸Œë„·, ê²Œì´íŠ¸ì›¨ì´
â”œâ”€â”€ security.tf      # ë³´ì•ˆ ê·¸ë£¹
â”œâ”€â”€ rds.tf           # PostgreSQL RDS
â”œâ”€â”€ ecr.tf           # ì»¨í…Œì´ë„ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬
â”œâ”€â”€ ecs.tf           # ECS í´ëŸ¬ìŠ¤í„°, íƒœìŠ¤í¬, ì„œë¹„ìŠ¤
â””â”€â”€ alb.tf           # ë¡œë“œ ë°¸ëŸ°ì„œ
```

## ê°€ì´ë“œ ìŠ¤íƒ€ì¼

- ëª¨ë“  ëª…ë ¹ì–´ì— **"ì´ ëª…ë ¹ì–´ê°€ ë¬´ì—‡ì„ í•˜ëŠ”ì§€"** ì„¤ëª…ì„ í¬í•¨í•œë‹¤
- ëª…ë ¹ì–´ì˜ ê° ì˜µì…˜/í”Œë˜ê·¸ë„ ê°„ë‹¨íˆ ì„¤ëª…í•œë‹¤
- ì²˜ìŒ ë“±ì¥í•˜ëŠ” ê°œë…ì€ ë¹„ìœ ë‚˜ ë¹„êµë¡œ ì‰½ê²Œ í’€ì–´ì¤€ë‹¤

## ì‚¬ìš©ì ë°°ê²½

- **Node.js/TypeScript ê²½í—˜ì**, GoëŠ” ì²˜ìŒ
- Go ë¬¸ë²•, í‚¤ì›Œë“œ, ê´€ë¡€ ë“± **ê¸°ì´ˆë¶€í„° ì„¤ëª… í•„ìš”**
- Node.jsì™€ ë¹„êµí•˜ë©´ ì´í•´ê°€ ë¹ ë¦„
- ì½”ë“œ ì˜ˆì‹œì—ëŠ” **ê° ì¤„ì˜ ì—­í• ê³¼ Go ë¬¸ë²• ì„¤ëª…**ì„ í¬í•¨í•œë‹¤
- ìƒˆë¡œìš´ Go í‚¤ì›Œë“œ/ë¬¸ë²•ì´ ì²˜ìŒ ë“±ì¥í•  ë•Œ ë°˜ë“œì‹œ ì„¤ëª…í•œë‹¤ (type, struct, :=, *, ëŒ€ì†Œë¬¸ì ê·œì¹™ ë“±)

## í•™ìŠµ ì§„í–‰ ìƒí™©

### Step 1: ê°œë°œ í™˜ê²½ ì¤€ë¹„ â€” âœ… ì™„ë£Œ

- [x] Go ì„¤ì¹˜ í™•ì¸ (v1.25)
- [x] Git ì„¤ì¹˜ í™•ì¸ (v2.47.0)
- [x] Docker ì„¤ì¹˜ í™•ì¸ (v27.4.0)
- [x] AWS CLI ì„¤ì¹˜ ë° ìê²© ì¦ëª… ì„¤ì •
- [x] Terraform ì„¤ì¹˜
- [x] Git ì´ˆê¸°í™”

### Step 2: Go + Gin í”„ë¡œì íŠ¸ ì´ˆê¸°í™” â€” âœ… ì™„ë£Œ

- [x] Go ëª¨ë“ˆ ì´ˆê¸°í™” (`go mod init`)
- [x] Gin í”„ë ˆì„ì›Œí¬ ì„¤ì¹˜
- [x] cmd/server/main.go ì‘ì„±
- [x] /health ì—”ë“œí¬ì¸íŠ¸ ë™ì‘ í™•ì¸

### Step 3: ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì„¤ê³„ â€” âœ… ì™„ë£Œ

- [x] ë¡œì»¬ PostgreSQL ì‹¤í–‰ (Docker Compose)
- [x] GORM ë° PostgreSQL ë“œë¼ì´ë²„ ì„¤ì¹˜
- [x] Payment ëª¨ë¸ ì„¤ê³„ (PaymentStatus enum í¬í•¨)
- [x] GORM AutoMigrateë¡œ í…Œì´ë¸” ìë™ ìƒì„±
- [x] Makefile, README.md, .gitignore ì¶”ê°€

### Step 4: API êµ¬í˜„ (ë¡œì»¬) â€” âœ… ì™„ë£Œ

- [x] POST /payments (ê²°ì œ ê¸°ë¡ ìƒì„±)
- [x] GET /payments (ëª©ë¡ ì¡°íšŒ + í•„í„°ë§ + í˜ì´ì§€ë„¤ì´ì…˜)
- [x] GET /payments/:id (ë‹¨ê±´ ì¡°íšŒ)
- [x] Status ìœ íš¨ì„± ê²€ì‚¬ (GORM BeforeCreate Hook)

### Step 5: Docker ì»¨í…Œì´ë„ˆí™” â€” âœ… ì™„ë£Œ

- [x] Dockerfile ì‘ì„± (ë©€í‹°ìŠ¤í…Œì´ì§€ ë¹Œë“œ)
- [x] docker-compose.ymlì— ì„œë²„ + DB êµ¬ì„±
- [x] í™˜ê²½ë³€ìˆ˜(DATABASE_URL)ë¡œ DB ì ‘ì† ì •ë³´ ë¶„ë¦¬
- [x] docker compose upìœ¼ë¡œ ì „ì²´ ì‹¤í–‰ í™•ì¸

### Step 6: Terraformìœ¼ë¡œ AWS ì¸í”„ë¼ êµ¬ì„± â€” ğŸ”„ ì§„í–‰ ì¤‘

#### 6-1. Terraform ê¸°ì´ˆ â€” âœ… ì™„ë£Œ
- [x] `terraform/` ë””ë ‰í† ë¦¬ ìƒì„±
- [x] `main.tf` â€” í”„ë¡œë°”ì´ë” ì„¤ì • (hashicorp/aws ~> 5.0)
- [x] `variables.tf` â€” ë³€ìˆ˜ ì •ì˜ (ë¦¬ì „, í”„ë¡œì íŠ¸ëª…, DB ì ‘ì†ì •ë³´)
- [x] `outputs.tf` â€” ì¶œë ¥ê°’ ì •ì˜ (ALB DNS)
- [x] `terraform init` ì„±ê³µ

#### 6-2. VPC ë„¤íŠ¸ì›Œí¬ êµ¬ì„± â€” ğŸ”„ ì§„í–‰ ì¤‘
- [x] `vpc.tf` ì‘ì„±
  - VPC (10.0.0.0/16)
  - Public Subnets 2ê°œ (ap-northeast-2a, 2c) â€” ALB + ECSìš©
  - Private Subnets 2ê°œ (ap-northeast-2a, 2c) â€” RDSìš©
  - Internet Gateway + Route Table
- [ ] `terraform validate` ë¬¸ë²• ê²€ì‚¬

#### 6-3. ë³´ì•ˆ ê·¸ë£¹ (Security Groups) â€” â³ ëŒ€ê¸°
#### 6-4. RDS PostgreSQL â€” â³ ëŒ€ê¸°
#### 6-5. ECR + ECS Fargate + ALB â€” â³ ëŒ€ê¸°
#### 6-6. ì „ì²´ ì—°ê²° ë° terraform apply â€” â³ ëŒ€ê¸°

### Step 7: ë°°í¬ ë° ê²€ì¦ â€” â³ ëŒ€ê¸°
